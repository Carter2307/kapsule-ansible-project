<?php
$db_host = "{{ hostvars[groups['dbservers'][0]].ansible_host | default('127.0.0.1') }}";
$db_name = "{{ mysql_app_db }}";
$db_user = "{{ mysql_app_user }}";
$db_pass = "{{ mysql_app_password }}";

$dsn = "mysql:host=$db_host;dbname=$db_name;charset=utf8mb4";
try {
    $pdo = new PDO($dsn, $db_user, $db_pass);
    $message = 'Database connection successful.';
} catch (PDOException $e) {
    $message = 'Database connection failed: ' . $e->getMessage();
}
?>
<h1>KapsuleKorp App</h1>
<p><?php echo $message; ?></p>
